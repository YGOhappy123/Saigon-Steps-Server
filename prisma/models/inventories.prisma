model ProductImport {
    importId            Int                  @id @default(autoincrement())
    invoiceNumber       String
    totalCost           Float
    importDate          DateTime
    trackedAt           DateTime             @default(now())
    trackedBy           Int
    trackedByStaff      Staff                @relation(fields: [trackedBy], references: [staffId])
    importItems         ImportItem[]
    inventoryUpdateLogs InventoryUpdateLog[]

    @@index([invoiceNumber])
    @@map("product_imports")
}

model ImportItem {
    importId      Int
    import        ProductImport @relation(fields: [importId], references: [importId])
    productItemId Int
    productItem   ProductItem   @relation(fields: [productItemId], references: [productItemId])
    cost          Float
    quantity      Int

    @@id([importId, productItemId])
    @@map("import_items")
}

model InventoryDamageReport {
    reportId            Int                   @id @default(autoincrement())
    totalExpectedCost   Float
    reason              InventoryDamageReason
    note                String?
    reportedAt          DateTime              @default(now())
    reportedBy          Int
    reportedByStaff     Staff                 @relation(fields: [reportedBy], references: [staffId])
    reportItems         DamageReportItem[]
    inventoryUpdateLogs InventoryUpdateLog[]

    @@map("inventory_damage_reports")
}

model DamageReportItem {
    reportId      Int
    report        InventoryDamageReport @relation(fields: [reportId], references: [reportId])
    productItemId Int
    productItem   ProductItem           @relation(fields: [productItemId], references: [productItemId])
    expectedCost  Float
    quantity      Int

    @@id([reportId, productItemId])
    @@map("damage_report_items")
}

model InventoryUpdateLog {
    logId          Int                    @id @default(autoincrement())
    productItemId  Int
    productItem    ProductItem            @relation(fields: [productItemId], references: [productItemId])
    quantity       Int
    type           InventoryUpdateType
    orderId        Int?
    order          Order?                 @relation(fields: [orderId], references: [orderId])
    importId       Int?
    import         ProductImport?         @relation(fields: [importId], references: [importId])
    damageReportId Int?
    damageReport   InventoryDamageReport? @relation(fields: [damageReportId], references: [reportId])
    updatedAt      DateTime               @default(now())

    @@map("inventory_update_logs")
}
